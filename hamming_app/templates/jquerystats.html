{% extends "layout.html" %}

{% block navbar %}
<li class="uk-parent"><a href="/">Encoder</a></li>
<li class="uk-active"><a href="/stats">Stats</a></li>
<li class="uk-parent"><a href="/visualization">Visualization</a></li>
{% endblock %}

{% block content %}
<h2>Test Configuration</h2>

<div class="uk-width-1-3@s">
    <div class="uk-margin uk-margin-small-left">
        <label class="uk-form-label" for="error-rate">Error Rate</label>
        <div class="uk-form-controls">
            <input class="uk-input" id="error-rate" name="error-rate" type="number" value="{{ error_rate }}" min="0.00" max="1.00" step="any">
        </div>
    </div>
</div>

<div class="uk-width-1-3@s">
    <div class="uk-margin-large uk-margin-left">
        <label class="uk-form-label" for="no-of-tests">Number of tests</label>
        <div class="uk-form-controls">
            <input class="uk-input" id="no-of-tests" name="no-of-tests" type="number" value="{{ no_of_tests }}" min="1" step="1">
        </div>
    </div>
</div>

<div class="uk-width-1-4@s">
    <div class="uk-margin-large uk-margin-left">
        <input class="uk-button uk-button-default" type="submit" value="Submit" id="submit-button" style="margin-top:24px;">
    </div>
</div>

<h2>Results</h2>

<table class="uk-table">
    <thead>
        <tr>
            <th>Parameter</th>
            <th>Length</th>
            <th>Data Ratio</th>
            <th>Theoretical</th>
            <th>Test Result</th>
        </tr>
    </thead>
    <tbody>
        {% for row in tablerows %}
        <tr>
            <td>{{ row.parameter }}</td>
            <td>{{ row.length }}</td>
            <td>{{ row.data_ratio }}</td>
            <td>{{ row.theory_rate }}</td>
            <td>{{ row.test_rate }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<script type="text/javascript">
    $(function() {
        $('#submit-button').bind('click', function() {
            updateForm("Encode");
        
        });

        $(".uk-input").keypress(function(e) {
            if (e.which == 13) {
                updateForm("Encode");
            }
        });

        function updateForm(mode) {

            $.post($SCRIPT_ROOT + '/_rawstats', {

                words: $('#words').val(),
                error_rate: $('#error-rate').val(),
                parameter: $('#parameter').val(),
                submit: mode

            }, function(data) {

                $('#words').val(data.words);

            }, "json").fail(function(xhr) {

                UIkit.notification({
                    message: xhr.responseJSON.message,
                    status: 'danger',
                    pos: 'top-center',
                    timeout: 4000
                });
                
            });
            return false;
        }
    });
</script>
{% endblock %}